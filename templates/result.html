<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LoanLens | Loan Recommendation</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>

<div class="container glass-heavy">

    <!-- HEADER -->
    <h2>Loan Recommendation Dashboard</h2>
    <p>
        Based on your financial profile and machine learning analysis,
        here are your most suitable loan options.
    </p>

    <!-- RISK -->
    <div class="risk {{ risk|lower }}">
        {{ risk }} Risk Profile
    </div>

    <!-- ğŸ† FLOATING BEST LOAN CARD -->
    {% if best_loan %}
    <div class="floating-loan-card">
        <div class="badge">BEST MATCH</div>

        <h3>ğŸ† Recommended Loan</h3>

        <p><strong>Loan Type:</strong> {{ best_loan.loan_name }}</p>
        <p><strong>Bank:</strong> {{ best_loan.bank }}</p>
        <p><strong>Approval Probability:</strong> {{ best_loan.approval_probability * 100 }}%</p>
        <p><strong>Eligible Amount:</strong> â‚¹{{ best_loan.eligible_amount }}</p>

        <div class="recommendation
            {% if 'Recommended' in best_loan.recommendation %}recommended
            {% elif 'Risky' in best_loan.recommendation %}risky
            {% else %}not{% endif %}">
            {{ best_loan.recommendation }}
        </div>

        <p class="muted" style="margin-top:12px;">
            Why? {{ best_loan.reason }}
        </p>
    </div>
    {% endif %}

    <!-- ğŸ“‹ TOP LOAN OPTIONS -->
    <div class="loan-card">
        <h3>Top Loan Suggestions</h3>

        {% if loans %}
        <table style="width:100%; margin-top:10px;">
            <tr>
                <th>#</th>
                <th>Loan</th>
                <th>Bank</th>
                <th>Score</th>
                <th>Status</th>
            </tr>

            {% for loan in loans %}
            <tr {% if loop.index == 1 %}style="font-weight:bold;"{% endif %}>
                <td>{{ loop.index }}</td>
                <td>{{ loan.loan_name }}</td>
                <td>{{ loan.bank }}</td>
                <td>{{ loan.score }}%</td>
                <td>{{ loan.recommendation }}</td>
            </tr>
            {% endfor %}
        </table>
        {% else %}
            <p>No loan options available.</p>
        {% endif %}
    </div>

    <!-- EXISTING LOAN -->
    <div class="loan-card">
        <h3>Existing Loan Status</h3>

        {% if pending_amount > 0 %}
            <p>ğŸ“Œ Pending Amount: â‚¹{{ pending_amount }}</p>
            <p>ğŸ“‰ Pending Interest: â‚¹{{ existing_interest }}</p>
        {% else %}
            <p>âœ… No existing loan liabilities.</p>
        {% endif %}
    </div>

    <!-- INTEREST COMPARISON -->
    <div class="loan-card">
        <h3>Interest Comparison</h3>
        <ul>
            <li>Existing Interest: â‚¹{{ existing_interest }}</li>
            <li>New Loan Interest: â‚¹{{ new_interest }}</li>

            {% if savings_percent > 0 %}
            <li>ğŸ’° Potential Savings: {{ savings_percent }}%</li>
            {% else %}
            <li>âš  No interest savings identified</li>
            {% endif %}
        </ul>
    </div>

    <!-- ADVISORY -->
    <div class="loan-card">
        <h3>Advisory Summary</h3>
        <p>{{ advisory }}</p>
    </div>

    <a href="{{ url_for('home') }}">â† Start New Analysis</a>

</div>

</body>
</html>
